var isStateChangeExecute=true,current_filter,current_viewType,current_tagType,current_language,current_mapStyle,current_zoomLevel,current_longitude,current_latitude,current_sceneId=0,current_birdseyeSceneOrientation=0,current_mapDetails="",current_horizontalColumnName,current_dateRange,current_verticalOptions,current_verticalColumnName,current_verticalColumnOptions,hash_filter,hash_viewType,hash_tagType,hash_language,hash_mapStyle,hash_zoomLevel,hash_longitude,hash_latitude,hash_sceneId=0,hash_birdseyeSceneOrientation=0,hash_horizontalColumnName,hash_dateRange,hash_verticalOptions,hash_verticalColumnName,hash_verticalColumnOptions,defaultZoomLevelOfMapSet=11,indexInHashWhereMapStyleStarts=3,isBookMarkedMapView="N",isHashChangeRoute=false,isBookmarkedUrl=false,birdsEyeViewSceneIdChange=false,centerPixel,birdsEyeViewZoomLevel=11,birdsEyeSceneGlobal="North";function getCurrentMapStatus(){try{current_mapStyle=map.GetMapStyle();switch(current_mapStyle){case "r":case "a":case "h":var center=map.GetCenter();current_zoomLevel=map.GetZoomLevel();current_longitude=center.Longitude;current_latitude=center.Latitude;current_mapDetails=current_mapStyle+"/"+current_zoomLevel+"/"+current_longitude+"/"+current_latitude;break;case "b":case "o":var birdseyeScene=map.GetBirdseyeScene();current_zoomLevel=map.GetZoomLevel();var centerPixel=birdseyeScene.LatLongToPixel(map.GetCenter(),current_zoomLevel);current_longitude=centerPixel.x;current_latitude=centerPixel.y;current_sceneId=birdseyeScene.GetID();current_birdseyeSceneOrientation=birdseyeScene.GetOrientation();current_mapDetails=current_mapStyle+"/"+current_zoomLevel+"/"+current_longitude+"/"+current_latitude+"/"+current_sceneId+"/"+current_birdseyeSceneOrientation;break}}catch(e){errorFunction(mapControlError,true);hideLoadingIndicator()}}function viewHandler(){if(current_viewType=="MapView"&&current_tagType=="Results"){var hashValue=createHashValue();Sys.Application.addHistoryPoint({param:hashValue},siteTitle)}}function setMapViewByHash(){try{map.DetachEvent("onchangeview",viewHandler);switch(hash_mapStyle){case "r":case "a":case "h":showLoadingIndicator();map.SetMapStyle(hash_mapStyle);getCurrentMapStatus();if(current_zoomLevel!=hash_zoomLevel||current_latitude!=hash_latitude||current_longitude!=hash_longitude){map.AttachEvent("onchangeview",hideLoadingIndicatorAndDetach);map.SetCenterAndZoom(new VELatLong(hash_latitude,hash_longitude),hash_zoomLevel)}else hideLoadingIndicatorAndDetach();break;case "o":case "b":showLoadingIndicator();if(current_mapStyle!=hash_mapStyle){map.AttachEvent("onchangemapstyle",onChangeMapStyleOfBirdsEye);map.SetMapStyle(hash_mapStyle)}else onChangeMapStyleOfBirdsEye();break}}catch(e){errorFunction(mapControlError,true);hideLoadingIndicator()}}function onChangeMapStyleOfBirdsEye(){try{map.DetachEvent("onchangemapstyle",onChangeMapStyleOfBirdsEye);if(current_sceneId!=hash_sceneId){map.AttachEvent("onobliquechange",onChangeSceneIdOfBirdsEye);map.SetBirdseyeScene(hash_sceneId)}else onChangeSceneIdOfBirdsEye()}catch(e){errorFunction(mapControlError,true);hideLoadingIndicator()}}function onChangeSceneIdOfBirdsEye(){try{map.DetachEvent("onobliquechange",onChangeSceneIdOfBirdsEye);map.AttachEvent("onchangeview",hideLoadingIndicatorAndDetach);birdsEyeViewZoomLevel=parseInt(hash_zoomLevel);centerPixel=new VEPixel(hash_longitude,hash_latitude);birdsEyeSceneGlobal=map.GetBirdseyeScene();var encLatLong=birdsEyeSceneGlobal.PixelToLatLong(centerPixel,birdsEyeViewZoomLevel);switch(hash_birdseyeSceneOrientation){case "North":map.SetBirdseyeScene(encLatLong,VEOrientation.North,birdsEyeViewZoomLevel,dummyCallback);break;case "South":map.SetBirdseyeScene(encLatLong,VEOrientation.South,birdsEyeViewZoomLevel,dummyCallback);break;case "East":map.SetBirdseyeScene(encLatLong,VEOrientation.East,birdsEyeViewZoomLevel,dummyCallback);break;case "West":map.SetBirdseyeScene(encLatLong,VEOrientation.West,birdsEyeViewZoomLevel,dummyCallback);break}}catch(e){errorFunction(mapControlError,true);hideLoadingIndicator()}}$(document).ready(function(){$("#LoadingIndicatorPanel").ajaxStart(function(){showLoadingIndicator()});$("#LoadingIndicatorPanel").ajaxStop(function(){hideLoadingIndicator()});$("select#languagesDataView").change(function(){languageDataViewSelectedIndexChanged()});$("select#languagesMapView").change(function(){languageMapViewSelectedIndexChanged()});$("select#languagesBarChartView").change(function(){languageBarChartViewSelectedIndexChanged()});$("select#languagesPieChartView").change(function(){languagePieChartViewSelectedIndexChanged()});$("#Para1").click(function(){$(this).next("#Para2").slideToggle(350);return false});$("#Para1").toggle(function(){$("#ExpandCollapseImage").attr("src",CollapserImage);$("#ExpandCollapseImage").attr("title","Hide Details");$("#ExpandCollapseImage").attr("alt","Hide Details")},function(){$("#ExpandCollapseImage").attr("src",ExpanderImage);$("#ExpandCollapseImage").attr("title","Show Details");$("#ExpandCollapseImage").attr("alt","Show Details")})});function initializePage(){$("#filterDialog").dialog({width:530,autoOpen:false,show:"slide",modal:true,resizable:false,position:"center"});$("#filterDialog").css({visibility:"visible",cursor:"pointer"});$("#tabs").tabs({select:tabsSelected});$("#tabs").css({visibility:"visible"});$("#sampleCodeTabs").tabs({select:tabsSelected});$("#sampleCodeTabs").css({visibility:"visible"});$("#copyDataCodeButton").click(copyDataCode);$("#copyMapCodeButton").click(copyMapCode);$("#copyBarChartCodeButton").click(copyBarChartCode);$("#copyPieChartCodeButton").click(copyPieChartCode);$.clipboardReady(clipboardReady,{swfpath:"~/Scripts/jquery.clipboard.swf"});Sys.Application.add_navigate(onStateChanged)}function page_init(){isBookmarkedUrl=true;isHashChangeRoute=false;map=new VEMap("myMap");map.AttachEvent("onerror",showMapControlError);map.LoadMap();map.Resize(862,450);initializePage();readHashValueIntoHashVariables();setPageAccordingToHashVariables()}function replaceCurrentVariablesWithHashVariables(){current_filter=hash_filter;current_viewType=hash_viewType;current_tagType=hash_tagType;current_language=hash_language;current_mapStyle=hash_mapStyle;current_zoomLevel=hash_zoomLevel;current_longitude=hash_longitude;current_latitude=hash_latitude;current_sceneId=hash_sceneId;current_birdseyeSceneOrientation=hash_birdseyeSceneOrientation;current_horizontalColumnName=hash_horizontalColumnName;current_dateRange=hash_dateRange;current_verticalOptions=hash_verticalOptions;current_verticalColumnName=hash_verticalColumnName;current_verticalColumnOptions=hash_verticalColumnOptions}function setDataView(){switch(hash_tagType){case "SampleCode":if(isHashChangeRoute){if(current_viewType!=hash_viewType){isBookmarkedUrl=true;!$("#liDataView").hasClass("ui-state-active")&&$("#tabs").tabs("select",0)}if(current_tagType!=hash_tagType){isBookmarkedUrl=true;$("#dataViewAccordion").accordion("activate",0)}if(current_language!=hash_language){isBookmarkedUrl=true;document.getElementById("languagesDataView").value=hash_language;languageDataViewSelectedIndexChanged()}if(current_filter!=hash_filter){isBookmarkedUrl=true;SetFilter(hash_filter);runClicked()}}else{!$("#liDataView").hasClass("ui-state-active")&&$("#tabs").tabs("select",0);$("#dataViewAccordion").accordion("activate",0);document.getElementById("languagesDataView").value=hash_language;languageDataViewSelectedIndexChanged();SetFilter(hash_filter);runClicked()}break;case "Results":if(isHashChangeRoute){if(current_viewType!=hash_viewType){isBookmarkedUrl=true;!$("#liDataView").hasClass("ui-state-active")&&$("#tabs").tabs("select",0)}if(current_tagType!=hash_tagType){isBookmarkedUrl=true;$("#dataViewAccordion").accordion("activate",1)}if(current_filter!=hash_filter){isBookmarkedUrl=true;SetFilter(hash_filter);runClicked()}}else{SetFilter(hash_filter);runClicked()}break}}function setMapView(){switch(hash_tagType){case "SampleCode":if(isHashChangeRoute){if(current_viewType!=hash_viewType){isBookmarkedUrl=true;!$("#liMapView").hasClass("ui-state-active")&&$("#tabs").tabs("select",1)}if(current_tagType!=hash_tagType){isBookmarkedUrl=true;$("#mapViewAccordion").accordion("activate",0)}if(current_language!=hash_language){isBookmarkedUrl=true;document.getElementById("languagesMapView").value=hash_language;languageMapViewSelectedIndexChanged()}if(current_filter!=hash_filter){isBookmarkedUrl=true;SetFilter(hash_filter);runClicked()}}else{!$("#liMapView").hasClass("ui-state-active")&&$("#tabs").tabs("select",1);$("#mapViewAccordion").accordion("activate",0);document.getElementById("languagesMapView").value=hash_language;languageMapViewSelectedIndexChanged();SetFilter(hash_filter);runClicked()}break;case "Results":if(isHashChangeRoute){if(current_viewType!=hash_viewType){isBookmarkedUrl=true;!$("#liMapView").hasClass("ui-state-active")&&$("#tabs").tabs("select",1)}if(current_tagType!=hash_tagType){isBookmarkedUrl=true;$("#mapViewAccordion").accordion("activate",1)}if(current_filter!=hash_filter){isBookMarkedMapView="N";isBookmarkedUrl=true;SetFilter(hash_filter);runClicked()}else setMapViewByHash()}else{!$("#liMapView").hasClass("ui-state-active")&&$("#tabs").tabs("select",1);isBookMarkedMapView="Y";SetFilter(hash_filter);runClicked()}break}}function setBarChartView(){switch(hash_tagType){case "SampleCode":if(isHashChangeRoute){if(current_viewType!=hash_viewType){isBookmarkedUrl=true;!$("#liBarChart").hasClass("ui-state-active")&&$("#tabs").tabs("select",2)}if(current_tagType!=hash_tagType){isBookmarkedUrl=true;$("#barChartAccordion").accordion("activate",0)}if(current_language!=hash_language){isBookmarkedUrl=true;document.getElementById("languagesBarChartView").value=hash_language;languageBarChartViewSelectedIndexChanged()}if(current_filter!=hash_filter){isBookmarkedUrl=true;SetFilter(hash_filter);runClicked()}}else{!$("#liBarChart").hasClass("ui-state-active")&&$("#tabs").tabs("select",2);$("#barChartAccordion").accordion("activate",0);document.getElementById("languagesBarChartView").value=hash_language;languageBarChartViewSelectedIndexChanged();SetFilter(hash_filter);runClicked()}break;case "Results":if(isHashChangeRoute){if(current_viewType!=hash_viewType){isBookmarkedUrl=true;!$("#liBarChart").hasClass("ui-state-active")&&$("#tabs").tabs("select",2)}if(current_tagType!=hash_tagType){isBookmarkedUrl=true;$("#barChartAccordion").accordion("activate",1)}if(current_filter!=hash_filter||current_horizontalColumnName!=hash_horizontalColumnName||current_dateRange!=hash_dateRange||current_verticalOptions!=hash_verticalOptions||current_verticalColumnName!=hash_verticalColumnName||current_verticalColumnOptions!=hash_verticalColumnOptions){isBookmarkedUrl=true;SetFilter(hash_filter);runClicked();isBookmarkedUrl=true;ResetBarChartFilter();SetBarChartFilter();drawBarChart(hash_filter,hash_horizontalColumnName,hash_dateRange,hash_verticalOptions,hash_verticalColumnName,hash_verticalColumnOptions)}}else{!$("#liBarChart").hasClass("ui-state-active")&&$("#tabs").tabs("select",2);SetFilter(hash_filter);runClicked();ResetBarChartFilter();SetBarChartFilter();drawBarChart(hash_filter,hash_horizontalColumnName,hash_dateRange,hash_verticalOptions,hash_verticalColumnName,hash_verticalColumnOptions)}break}}function setPieChartView(){switch(hash_tagType){case "SampleCode":if(isHashChangeRoute){if(current_viewType!=hash_viewType){isBookmarkedUrl=true;!$("#liPieChart").hasClass("ui-state-active")&&$("#tabs").tabs("select",3)}if(current_tagType!=hash_tagType){isBookmarkedUrl=true;$("#pieChartAccordion").accordion("activate",0)}if(current_language!=hash_language){isBookmarkedUrl=true;document.getElementById("languagesPieChartView").value=hash_language;languagePieChartViewSelectedIndexChanged()}if(current_filter!=hash_filter){isBookmarkedUrl=true;SetFilter(hash_filter);runClicked()}}else{!$("#liPieChart").hasClass("ui-state-active")&&$("#tabs").tabs("select",3);$("#pieChartAccordion").accordion("activate",0);document.getElementById("languagesPieChartView").value=hash_language;languagePieChartViewSelectedIndexChanged();SetFilter(hash_filter);runClicked()}break;case "Results":if(isHashChangeRoute){if(current_viewType!=hash_viewType){isBookmarkedUrl=true;!$("#liPieChart").hasClass("ui-state-active")&&$("#tabs").tabs("select",3)}if(current_tagType!=hash_tagType){isBookmarkedUrl=true;$("#pieChartAccordion").accordion("activate",1)}if(current_filter!=hash_filter||current_horizontalColumnName!=hash_horizontalColumnName||current_dateRange!=hash_dateRange||current_verticalOptions!=hash_verticalOptions||current_verticalColumnName!=hash_verticalColumnName||current_verticalColumnOptions!=hash_verticalColumnOptions){isBookmarkedUrl=true;SetFilter(hash_filter);runClicked();isBookmarkedUrl=true;ResetPieChartFilter();SetPieChartFilter();drawPieChart(hash_filter,hash_horizontalColumnName,hash_dateRange,hash_verticalOptions,hash_verticalColumnName,hash_verticalColumnOptions)}}else{!$("#liPieChart").hasClass("ui-state-active")&&$("#tabs").tabs("select",3);SetFilter(hash_filter);runClicked();ResetPieChartFilter();SetPieChartFilter();drawPieChart(hash_filter,hash_horizontalColumnName,hash_dateRange,hash_verticalOptions,hash_verticalColumnName,hash_verticalColumnOptions)}break}}function setPageAccordingToHashVariables(){isBookmarkedUrl&&replaceCurrentVariablesWithHashVariables();switch(hash_viewType){case "DataView":setDataView();isHashChangeRoute=false;isBookmarkedUrl=false;break;case "MapView":setMapView();isHashChangeRoute=false;isBookmarkedUrl=false;break;case "BarChartView":setBarChartView();isHashChangeRoute=false;isBookmarkedUrl=false;break;case "PieChartView":setPieChartView();isHashChangeRoute=false;isBookmarkedUrl=false;break}}function showMapControlError(){alert(mapControlError)}function wheelCallback(e){window.scrollBy(0,-5*e.mouseWheelChange);return true}function onStateChanged(sender,e){if(isDeltaInHashAndCurrent()){isBookmarkedUrl=false;isHashChangeRoute=true;setPageAccordingToHashVariables()}}function isDeltaInHashAndCurrent(){readHashValueIntoHashVariables();var fillCurrentVaribles=createHashValue();switch(hash_viewType){case "DataView":switch(hash_tagType){case "SampleCode":if(hash_filter!=current_filter||hash_viewType!=current_viewType||hash_tagType!=current_tagType||hash_language!=current_language)return true;else return false;break;case "Results":if(hash_filter!=current_filter||hash_viewType!=current_viewType||hash_tagType!=current_tagType)return true;else return false;break}break;case "MapView":switch(hash_tagType){case "SampleCode":if(hash_filter!=current_filter||hash_viewType!=current_viewType||hash_tagType!=current_tagType||hash_language!=current_language)return true;else return false;break;case "Results":getCurrentMapStatus();switch(hash_mapStyle){case "r":case "a":case "h":if(hash_filter!=current_filter||hash_viewType!=current_viewType||hash_tagType!=current_tagType||hash_mapStyle!=current_mapStyle||hash_zoomLevel!=current_zoomLevel||hash_longitude!=current_longitude||hash_latitude!=current_latitude)return true;else return false;break;case "b":case "o":if(hash_filter!=current_filter||hash_viewType!=current_viewType||hash_tagType!=current_tagType||hash_mapStyle!=current_mapStyle||hash_zoomLevel!=current_zoomLevel||hash_longitude!=current_longitude||hash_latitude!=current_latitude||hash_sceneId!=current_sceneId||hash_birdseyeSceneOrientation!=current_birdseyeSceneOrientation)return true;else return false;break}break}break;case "BarChartView":case "PieChartView":switch(hash_tagType){case "SampleCode":if(hash_filter!=current_filter||hash_viewType!=current_viewType||hash_tagType!=current_tagType||hash_language!=current_language)return true;else return false;break;case "Results":if(hash_filter!=current_filter||hash_viewType!=current_viewType||hash_tagType!=current_tagType||hash_horizontalColumnName!=current_horizontalColumnName||hash_dateRange!=current_dateRange||hash_verticalOptions!=current_verticalOptions||hash_verticalColumnName!=current_verticalColumnName||hash_verticalColumnOptions!=current_verticalColumnOptions)return true;else return false;break}break}}function errorFunction(error,isString){if(!isString)error=error.statusText;$.ajax({type:"POST",url:"../DataBrowserError/",data:{error:error},dataType:"html",success:function(html){document.getElementById("divError").style.display="block";$("#divError").html(html);document.getElementById("tabs").style.display="none"}})}function getData(filter){$.ajax({type:"POST",url:"../DataBrowserRun/",data:{container:container,entitySet:entitySet,filter:filter},dataType:"html",error:function(error){errorFunction(error,false)},success:function(html){if(html.toString().indexOf('id="pError"',0)>=0){document.getElementById("divError").style.display="block";$("#divError").html(html);document.getElementById("tabs").style.display="none"}else{document.getElementById("divError").style.display="none";document.getElementById("tabs").style.display="block";document.getElementById("tabs").style.visibility="visible";$("#divDataViewResults").html(html)}}})}function SetPagingLinkVisibility(){var prevEnable=document.getElementById("labelPrevEnable").title,nextEnable=document.getElementById("labelNextEnable").title;if(prevEnable=="1")document.getElementById("prevLink").disabled=false;else{document.getElementById("prevLink").disabled=true;document.getElementById("prevLink").className="disabled"}if(nextEnable=="1")document.getElementById("nextLink").disabled=false;else{document.getElementById("nextLink").disabled=true;document.getElementById("nextLink").className="disabled"}}function ShowFilterHintsDialog(){$("#filterDialog").dialog("open")}function ShowHideError(){var error=document.getElementById("labelError").title;if(error=="")document.getElementById("divError").style.display="none";else document.getElementById("divError").style.display="block"}function languageDataViewSelectedIndexChanged(){current_language=readSampleCodeLanguageFromActiveViewType();var hashValue=createHashValue();changeDataViewLanguage(current_language);if(isBookmarkedUrl==false)Sys.Application.addHistoryPoint({param:hashValue},siteTitle);else isBookmarkedUrl=false}function changeDataViewLanguage(selectedLanguage){$.ajax({type:"POST",url:"../LoadSampleCodeDataView/",data:{selectedFileName:selectedLanguage,container:container,entitySet:entitySet},dataType:"html",success:function(html){$("#divDataViewSampleCode").html(html)}})}function changeMapViewLanguage(selectedLanguage){$.ajax({type:"POST",url:"../LoadSampleCodeMapView/",data:{selectedFileName:selectedLanguage,container:container,entitySet:entitySet},dataType:"html",success:function(html){$("#divMapViewSampleCode").html(html)}})}function languageMapViewSelectedIndexChanged(){var hashValue=createHashValue();changeMapViewLanguage(current_language);if(isBookmarkedUrl==false)Sys.Application.addHistoryPoint({param:hashValue},siteTitle);else isBookmarkedUrl=false}function languageBarChartViewSelectedIndexChanged(){var hashValue=createHashValue();changeBarChartViewLanguage(current_language);if(isBookmarkedUrl==false)Sys.Application.addHistoryPoint({param:hashValue},siteTitle);else isBookmarkedUrl=false}function changeBarChartViewLanguage(selectedLanguage){$.ajax({type:"POST",url:"../LoadSampleCodeBarChartView/",data:{selectedFileName:selectedLanguage,container:container,entitySet:entitySet},dataType:"html",success:function(html){$("#divBarChartViewSampleCode").html(html)}})}function languagePieChartViewSelectedIndexChanged(){var hashValue=createHashValue();changePieChartViewLanguage(current_language);if(isBookmarkedUrl==false)Sys.Application.addHistoryPoint({param:hashValue},siteTitle);else isBookmarkedUrl=false}function changePieChartViewLanguage(selectedLanguage){$.ajax({type:"POST",url:"../LoadSampleCodePieChartView/",data:{selectedFileName:selectedLanguage,container:container,entitySet:entitySet},dataType:"html",success:function(html){$("#divPieChartViewSampleCode").html(html)}})}function previousClicked(){if($("#prevLink").hasClass("disabled")==false){var filter=current_filter;SetFilter(filter);$.ajax({type:"POST",url:"../DataBrowserPaging/",data:{container:container,entitySet:entitySet,filter:filter,link:"Previous"},dataType:"html",error:function(error){errorFunction(error,false)},success:function(html){if(html.toString().indexOf('id="pError"',0)>=0){document.getElementById("divError").style.display="block";$("#divError").html(html);document.getElementById("tabs").style.display="none"}else{document.getElementById("divError").style.display="none";document.getElementById("tabs").style.display="block";document.getElementById("tabs").style.visibility="visible";$("#divDataViewResults").html(html)}}})}}function nextClicked(){if($("#nextLink").hasClass("disabled")==false){var filter=current_filter;SetFilter(filter);$.ajax({type:"POST",url:"../DataBrowserPaging/",data:{container:container,entitySet:entitySet,filter:filter,link:"Next"},dataType:"html",error:function(error){errorFunction(error,false)},success:function(html){if(html.toString().indexOf('id="pError"',0)>=0){document.getElementById("divError").style.display="block";$("#divError").html(html);document.getElementById("tabs").style.display="none"}else{document.getElementById("divError").style.display="none";document.getElementById("tabs").style.display="block";document.getElementById("tabs").style.visibility="visible";$("#divDataViewResults").html(html)}}})}}function getDefaultHashValueFor(defaultViewToGo,defaultTagToGo){hash_filter=noFilterText;switch(defaultViewToGo){case "DataView":hash_viewType="DataView";switch(defaultTagToGo){case "SampleCode":hash_tagType="SampleCode";hash_language=$("[id =languages"+hash_viewType+"]")[0].value;break;case "Results":hash_tagType="Results";break}break;case "MapView":hash_viewType="MapView";switch(defaultTagToGo){case "SampleCode":hash_tagType="SampleCode";hash_language=$("[id =languages"+hash_viewType+"]")[0].value;break;case "Results":hash_tagType="Results";hash_mapStyle="r";hash_zoomLevel=1;hash_longitude="0";hash_latitude="0";break}break;case "BarChartView":hash_viewType="BarChartView";switch(defaultTagToGo){case "SampleCode":hash_tagType="SampleCode";hash_language=$("[id =languages"+hash_viewType+"]")[0].value;break;case "Results":hash_tagType="Results";hash_horizontalColumnName="X";hash_dateRange="X";hash_verticalOptions="Option1";hash_verticalColumnName="X";hash_verticalColumnOptions="Aggregate";break}break;case "PieChartView":hash_viewType="PieChartView";switch(defaultTagToGo){case "SampleCode":hash_tagType="SampleCode";hash_language=$("[id =languages"+hash_viewType+"]")[0].value;break;case "Results":hash_tagType="Results";hash_horizontalColumnName="X";hash_dateRange="X";hash_verticalOptions="Option1";hash_verticalColumnName="X";hash_verticalColumnOptions="Aggregate";break}break}}function isValuePresentInLanguageComboBox(languageInHash,viewType){for(var dropDownList=$("[id =languages"+viewType+"]"),i=0;i<dropDownList[0].length;i++)if(dropDownList[0][i].value==languageInHash)return true;return false}function readHashValueIntoHashVariables(){var hashURL=window.location.hash;if(hashURL==""||hashURL=="#"){getDefaultHashValueFor("DataView","Results");return}var hashParametersArray=decodeURI(hashURL).substr(7).split(hashSeparator);if(hashParametersArray.length<=2){getDefaultHashValueFor("DataView","Results");return}if(hashParametersArray.length>=2){hash_filter=unescape(hashParametersArray[0]);hash_viewType=hashParametersArray[1];hash_tagType=hashParametersArray[2];switch(hash_viewType){case "DataView":switch(hash_tagType){case "SampleCode":hash_language=hashParametersArray[3];(hash_language==""||!isValuePresentInLanguageComboBox(hash_language,"DataView"))&&getDefaultHashValueFor("DataView","SampleCode");break;case "Results":break;default:getDefaultHashValueFor("DataView","Results");break}break;case "MapView":switch(hash_tagType){case "SampleCode":hash_language=hashParametersArray[3];(hash_language==""||!isValuePresentInLanguageComboBox(hash_language,"MapView"))&&getDefaultHashValueFor("MapView","SampleCode");break;case "Results":hash_mapStyle=hashParametersArray[indexInHashWhereMapStyleStarts];if(hash_mapStyle!="r"&&hash_mapStyle!="a"&&hash_mapStyle!="h"&&hash_mapStyle!="o"&&hash_mapStyle!="b"){getDefaultHashValueFor("MapView","Results");return}hash_zoomLevel=parseInt(hashParametersArray[indexInHashWhereMapStyleStarts+1]);if(isNaN(hash_zoomLevel)){getDefaultHashValueFor("MapView","Results");return}hash_longitude=hashParametersArray[indexInHashWhereMapStyleStarts+2];if(isNaN(hash_longitude)){getDefaultHashValueFor("MapView","Results");return}hash_latitude=hashParametersArray[indexInHashWhereMapStyleStarts+3];if(isNaN(hash_latitude)){getDefaultHashValueFor("MapView","Results");return}switch(hash_mapStyle){case "b":case "o":hash_sceneId=hashParametersArray[indexInHashWhereMapStyleStarts+4];if(isNaN(hash_sceneId)){getDefaultHashValueFor("MapView","Results");return}hash_birdseyeSceneOrientation=hashParametersArray[indexInHashWhereMapStyleStarts+5];if(hash_birdseyeSceneOrientation!="North"&&hash_birdseyeSceneOrientation!="South"&&hash_birdseyeSceneOrientation!="East"&&hash_birdseyeSceneOrientation!="West"){getDefaultHashValueFor("MapView","Results");return}break}break;default:getDefaultHashValueFor("MapView","Results");break}break;case "BarChartView":switch(hash_tagType){case "SampleCode":hash_language=hashParametersArray[3];(hash_language==""||!isValuePresentInLanguageComboBox(hash_language,"BarChartView"))&&getDefaultHashValueFor("BarChartView","SampleCode");break;case "Results":hash_horizontalColumnName=hashParametersArray[3];hash_dateRange=hashParametersArray[4];hash_verticalOptions=hashParametersArray[5];hash_verticalColumnName=hashParametersArray[6];hash_verticalColumnOptions=hashParametersArray[7];break;default:getDefaultHashValueFor("BarChartView","Results");break}break;case "PieChartView":switch(hash_tagType){case "SampleCode":hash_language=hashParametersArray[3];(hash_language==""||!isValuePresentInLanguageComboBox(hash_language,"PieChartView"))&&getDefaultHashValueFor("PieChartView","SampleCode");break;case "Results":hash_horizontalColumnName=hashParametersArray[3];hash_dateRange=hashParametersArray[4];hash_verticalOptions=hashParametersArray[5];hash_verticalColumnName=hashParametersArray[6];hash_verticalColumnOptions=hashParametersArray[7];break;default:getDefaultHashValueFor("PieChartView","Results");break}break;default:getDefaultHashValueFor("DataView","Results");break}}}function runClicked(){current_filter=GetFilter();getData(current_filter);loadKml(current_filter);if(isBookmarkedUrl==false){switch(current_viewType){case "DataView":case "MapView":ResetBarChartFilter();ResetPieChartFilter();break;case "BarChartView":if(current_tagType=="Results"){getBarChart();ResetPieChartFilter()}break;case "PieChartView":if(current_tagType=="Results"){getPieChart();ResetBarChartFilter()}break}var hashValue=createHashValue();Sys.Application.addHistoryPoint({param:hashValue},siteTitle)}else isBookmarkedUrl=false}function readSampleCodeLanguageFromActiveViewType(){switch(current_viewType){case "DataView":return $("#languagesDataView > option:selected").attr("value");case "MapView":return $("#languagesMapView > option:selected").attr("value");case "BarChartView":return $("#languagesBarChartView > option:selected").attr("value");case "PieChartView":return $("#languagesPieChartView > option:selected").attr("value")}}function createHashValue(){switch(current_tagType){case "SampleCode":current_language=readSampleCodeLanguageFromActiveViewType();return escape(current_filter)+hashSeparator+current_viewType+hashSeparator+current_tagType+hashSeparator+current_language;case "Results":switch(current_viewType){case "DataView":return escape(current_filter)+hashSeparator+current_viewType+hashSeparator+current_tagType;case "MapView":try{current_mapStyle=map.GetMapStyle();switch(current_mapStyle){case "r":case "a":case "h":var center=map.GetCenter();current_zoomLevel=map.GetZoomLevel();current_longitude=center.Longitude;current_latitude=center.Latitude;current_mapDetails=current_mapStyle+hashSeparator+current_zoomLevel+hashSeparator+current_longitude+hashSeparator+current_latitude;break;case "b":case "o":var birdseyeScene=map.GetBirdseyeScene();current_zoomLevel=map.GetZoomLevel();var centerPixel=birdseyeScene.LatLongToPixel(map.GetCenter(),current_zoomLevel);current_longitude=centerPixel.x;current_latitude=centerPixel.y;current_sceneId=birdseyeScene.GetID();current_birdseyeSceneOrientation=birdseyeScene.GetOrientation();current_mapDetails=current_mapStyle+hashSeparator+current_zoomLevel+hashSeparator+current_longitude+hashSeparator+current_latitude+hashSeparator+current_sceneId+hashSeparator+current_birdseyeSceneOrientation;break}}catch(e){errorFunction(mapControlError,true);hideLoadingIndicator()}return escape(current_filter)+hashSeparator+current_viewType+hashSeparator+current_tagType+hashSeparator+current_mapDetails;case "BarChartView":getBarChartParametersInCurrentVariables();return escape(current_filter)+hashSeparator+current_viewType+hashSeparator+current_tagType+hashSeparator+current_horizontalColumnName+hashSeparator+current_dateRange+hashSeparator+current_verticalOptions+hashSeparator+current_verticalColumnName+hashSeparator+current_verticalColumnOptions;case "PieChartView":getPieChartParametersInCurrentVariables();return escape(current_filter)+hashSeparator+current_viewType+hashSeparator+current_tagType+hashSeparator+current_horizontalColumnName+hashSeparator+current_dateRange+hashSeparator+current_verticalOptions+hashSeparator+current_verticalColumnName+hashSeparator+current_verticalColumnOptions}break}}function ResetBarChartFilter(){document.getElementById("ddlBarHorizontal")[0].selected=true;document.getElementById("ddlBarVertical")[0].selected=true;$("#labelBarDateRange").attr("style","display:none;");document.getElementById("ddlBarDateRange").style.display="none";var barVerticalOptions=document.getElementsByName("BarVerticalOptions");barVerticalOptions[0].checked="checked";barOption1Selected();columnNameSelected=horizontalAxisColText;$("#labelBarCount > span").remove();$("#labelBarCount").append("<span>&ldquo;"+columnNameSelected+"&rdquo;</span>");var barVerticalColumnOptions=document.getElementsByName("BarVerticalColumnOptions");barVerticalColumnOptions[0].checked="checked";document.getElementById("divBarChartResults").style.display="none"}function ResetPieChartFilter(){document.getElementById("ddlPieHorizontal")[0].selected=true;document.getElementById("ddlPieVertical")[0].selected=true;$("#labelPieDateRange").attr("style","display:none;");document.getElementById("ddlPieDateRange").style.display="none";var pieVerticalOptions=document.getElementsByName("PieVerticalOptions");pieVerticalOptions[0].checked="checked";pieOption1Selected();columnNameSelected=horizontalAxisColText;$("#labelPieCount > span").remove();$("#labelPieCount").append("<span>&ldquo;"+columnNameSelected+"&rdquo;</span>");var pieVerticalColumnOptions=document.getElementsByName("PieVerticalColumnOptions");pieVerticalColumnOptions[0].checked="checked";document.getElementById("divPieChartResults").style.display="none"}function getBarChart(){var hashValue=createHashValue();drawBarChart(current_filter,current_horizontalColumnName,current_dateRange,current_verticalOptions,current_verticalColumnName,current_verticalColumnOptions);SetFilter(current_filter);if(isBookmarkedUrl==false)Sys.Application.addHistoryPoint({param:hashValue},siteTitle);else isBookmarkedUrl=false}function drawBarChart(filter,xCol,xRange,yOption,yCol,yColOption){SetFilter(filter);if(xCol=="X"||yOption=="Option2"&&yCol=="X"){ShowBarChartError();return}var divChart=document.getElementById("divBarChartResults");divChart.style.overflow="scroll";$.ajax({type:"POST",url:"../DataBrowserRunBarChart/",data:{horizontalColumnName:xCol,dateRange:xRange,verticalOptions:yOption,verticalColumnName:yCol,verticalColumnOptions:yColOption,container:container,entitySet:entitySet,filter:filter},dataType:"html",error:function(error){errorFunction(error,false)},success:function(html){if(html.toString().indexOf('id="pError"',0)>=0){document.getElementById("divError").style.display="block";$("#divError").html(html);document.getElementById("tabs").style.display="none"}else{document.getElementById("divError").style.display="none";document.getElementById("tabs").style.display="block";document.getElementById("tabs").style.visibility="visible";$("#divBarChartResults").html(html)}}});showBarChartGraph()}function SetBarChartFilter(){var currentHzText=$("#ddlBarHorizontal > option:selected").attr("text"),optionsHz=$("#ddlBarHorizontal > option");if(hash_horizontalColumnName==undefined||hash_horizontalColumnName==defaultSelectOneText||hash_horizontalColumnName=="X")optionsHz[0].selected=true;else if(currentHzText==hash_horizontalColumnName)if(optionsHz[$("#ddlBarHorizontal > option:selected").attr("index")].value.split("^")[0]=="System.DateTime"){$("#labelBarDateRange").attr("style","display:block;");$("#ddlBarDateRange").attr("style","display:block;")}else{$("#labelBarDateRange").attr("style","display:none;");$("#ddlBarDateRange").attr("style","display:none;")}else for(i=0;i<optionsHz.length;i++)if(optionsHz[i].innerText==hash_horizontalColumnName){optionsHz[i].selected=true;if(optionsHz[i].value.split("^")[0]=="System.DateTime"){$("#labelBarDateRange").attr("style","display:block;");$("#ddlBarDateRange").attr("style","display:block;")}else{$("#labelBarDateRange").attr("style","display:none;");$("#ddlBarDateRange").attr("style","display:none;")}}else optionsHz[i].selected=false;SetBarChartLabel();var currentDtText=$("#ddlBarDateRange > option:selected").attr("text"),optionsDt=$("#ddlBarDateRange > option");if(currentDtText!=hash_dateRange)for(i=0;i<optionsDt.length;i++)if(optionsDt[i].innerText==hash_dateRange)optionsDt[i].selected=true;else optionsDt[i].selected=false;var barVerticalOptions=document.getElementsByName("BarVerticalOptions");if(hash_verticalOptions=="Option1"){barVerticalOptions[0].checked="checked";barOption1Selected()}else if(hash_verticalOptions=="Option2"){barVerticalOptions[1].checked="checked";barOption2Selected()}var currentVtText=$("#ddlBarVertical > option:selected").attr("text"),optionsVt=$("#ddlBarVertical > option");if(hash_verticalColumnName==undefined||hash_verticalColumnName==defaultSelectOneText||hash_verticalColumnName=="X")optionsVt[0].selected=true;else if(currentVtText!=hash_verticalColumnName)for(i=0;i<optionsVt.length;i++)if(optionsVt[i].innerText==hash_verticalColumnName){optionsVt[i].selected=true;break}var barVerticalColumnOptions=document.getElementsByName("BarVerticalColumnOptions");if(hash_verticalColumnOptions=="Aggregate")barVerticalColumnOptions[0].checked="checked";else if(hash_verticalColumnOptions=="Average")barVerticalColumnOptions[1].checked="checked";document.getElementById("divBarChartResults").style.display="none"}function SetPieChartFilter(){var currentHzText=$("#ddlPieHorizontal > option:selected").attr("text"),optionsHz=$("#ddlPieHorizontal > option");if(hash_horizontalColumnName==undefined||hash_horizontalColumnName==defaultSelectOneText||hash_horizontalColumnName=="X")optionsHz[0].selected=true;else if(currentHzText==hash_horizontalColumnName)if(optionsHz[$("#ddlPieHorizontal > option:selected").attr("index")].value.split("^")[0]=="System.DateTime"){$("#labelPieDateRange").attr("style","display:block;");$("#ddlPieDateRange").attr("style","display:block;")}else{$("#labelPieDateRange").attr("style","display:none;");$("#ddlPieDateRange").attr("style","display:none;")}else for(i=0;i<optionsHz.length;i++)if(optionsHz[i].innerText==hash_horizontalColumnName){optionsHz[i].selected=true;if(optionsHz[i].value.split("^")[0]=="System.DateTime"){$("#labelPieDateRange").attr("style","display:block;");$("#ddlPieDateRange").attr("style","display:block;")}else{$("#labelPieDateRange").attr("style","display:none;");$("#ddlPieDateRange").attr("style","display:none;")}}else optionsHz[i].selected=false;SetPieChartLabel();var currentDtText=$("#ddlPieDateRange > option:selected").attr("text"),optionsDt=$("#ddlPieDateRange > option");if(currentDtText!=hash_dateRange)for(i=0;i<optionsDt.length;i++)if(optionsDt[i].innerText==hash_dateRange)optionsDt[i].selected=true;else optionsDt[i].selected=false;var pieVerticalOptions=document.getElementsByName("PieVerticalOptions");if(hash_verticalOptions=="Option1"){pieVerticalOptions[0].checked="checked";pieOption1Selected()}else if(hash_verticalOptions=="Option2"){pieVerticalOptions[1].checked="checked";pieOption2Selected()}var currentVtText=$("#ddlPieVertical > option:selected").attr("text"),optionsVt=$("#ddlPieVertical > option");if(hash_verticalColumnName==undefined||hash_verticalColumnName==defaultSelectOneText||hash_verticalColumnName=="X")optionsVt[0].selected=true;else if(currentVtText!=hash_verticalColumnName)for(i=0;i<optionsVt.length;i++)if(optionsVt[i].innerText==hash_verticalColumnName){optionsVt[i].selected=true;break}var pieVerticalColumnOptions=document.getElementsByName("PieVerticalColumnOptions");if(hash_verticalColumnOptions=="Aggregate")pieVerticalColumnOptions[0].checked="checked";else if(hash_verticalColumnOptions=="Average")pieVerticalColumnOptions[1].checked="checked";document.getElementById("divPieChartResults").style.display="none"}function getPieChart(){var hashValue=createHashValue();drawPieChart(current_filter,current_horizontalColumnName,current_dateRange,current_verticalOptions,current_verticalColumnName,current_verticalColumnOptions);SetFilter(current_filter);if(isBookmarkedUrl==false)Sys.Application.addHistoryPoint({param:hashValue},siteTitle);else isBookmarkedUrl=false}function drawPieChart(filter,xCol,xRange,yOption,yCol,yColOption){SetFilter(filter);if(xCol=="X"||yOption=="Option2"&&yCol=="X"){ShowPieChartError();return}$.ajax({type:"POST",url:"../DataBrowserRunPieChart/",data:{horizontalColumnName:xCol,dateRange:xRange,verticalOptions:yOption,verticalColumnName:yCol,verticalColumnOptions:yColOption,container:container,entitySet:entitySet,filter:filter},dataType:"html",error:function(error){errorFunction(error,false)},success:function(html){if(html.toString().indexOf('id="pError"',0)>=0){document.getElementById("divError").style.display="block";$("#divError").html(html);document.getElementById("tabs").style.display="none"}else{document.getElementById("divError").style.display="none";document.getElementById("tabs").style.display="block";document.getElementById("tabs").style.visibility="visible";$("#divPieChartResults").html(html)}}});showPieChartGraph()}function clipboardReady(){$("#copyDataCodeButton").css({visibility:"visible",cursor:"pointer"});$("#copyMapCodeButton").css({visibility:"visible",cursor:"pointer"});$("#copyBarChartCodeButton").css({visibility:"visible",cursor:"pointer"});$("#copyPieChartCodeButton").css({visibility:"visible",cursor:"pointer"})}function tabsSelected(event,ui){switch(ui.index){case 0:current_viewType="DataView";map.DetachEvent("onchangeview",viewHandler);break;case 1:current_viewType="MapView";map.AttachEvent("onchangeview",viewHandler);break;case 2:current_viewType="BarChartView";map.DetachEvent("onchangeview",viewHandler);break;case 3:current_viewType="PieChartView";map.DetachEvent("onchangeview",viewHandler);break}current_tagType="Results";if(isBookmarkedUrl==false){var hashValue=createHashValue();Sys.Application.addHistoryPoint({param:hashValue},siteTitle)}}function loadKml(filter){map.DetachEvent("onchangeview",viewHandler);if(filter==noFilterText)filter="";map.Clear();kmlLayer=new VEShapeLayer;kmlQuery=document.getElementById("labelBaseQuery").title+"?";if(filter!=defaultFilterText&&document.getElementById("queryBox")!="")kmlQuery+="$filter="+filter;kmlQuery+="&format=kml";var veLayerSpec=new VEShapeSourceSpecification(VEDataType.ImportXML,kmlQuery+"&$top=50",kmlLayer);map.ImportShapeLayerData(veLayerSpec,kmlLoaded,true)}function kmlLoaded(veShapeLayer){map.DetachEvent("onchangeview",viewHandler);var shapeCount=veShapeLayer.GetShapeCount();if(shapeCount>0){setCustomPushpins(veShapeLayer);hidePolyIcon(veShapeLayer);$("#mapFullQueryUrlHyperlink").html(kmlQuery);$("#mapFullQueryUrlHyperlink").attr({href:kmlQuery});$("#mapFullQueryPanel").show();$("#mapNoResultsDiv").hide();if(shapeCount==50)$("#mapManyPlacemarksDiv").show();else $("#mapManyPlacemarksDiv").hide()}else{$("#mapFullQueryPanel").hide();$("#mapNoResultsDiv").show();$("#mapManyPlacemarksDiv").show();$("#tabs-2").hide();$("#liMapView").hide()}map.AttachEvent("onchangeview",viewHandler);setMapViewState()}function hidePolyIcon(layer){for(var shapeCount=layer.GetShapeCount(),i=0;i<shapeCount;i++){var shape=layer.GetShapeByIndex(i);shape.GetType()==VEShapeType.Polygon&&shape.HideIcon()}}function setCustomPushpins(layer){for(var numShapes=layer.GetShapeCount(),shape,i=0;i<numShapes;++i){shape=layer.GetShapeByIndex(i);shape.SetCustomIcon("<img src='/Images/pushpin.png' alt='image showing the location of the selected place' longdesc='desc/longdesc.txt'/>")}var customIcon=new VECustomIconSpecification;customIcon.Image="/Images/pushpin-expand.png";var options=new VEClusteringOptions;options.Icon=customIcon;layer.SetClusteringConfiguration(VEClusteringType.Grid,options);map.AttachEvent("onchangeview",viewHandler)}function setMapViewState(){switch(isBookMarkedMapView){case "N":hash_viewType=="MapView"&&hash_tagType=="Results"&&setMapViewByHash();break;case "Y":map.DetachEvent("onchangeview",viewHandler);isBookMarkedMapView="N";showLoadingIndicator();mapMode=1;mapStyle=hash_mapStyle;zoomLevel=hash_zoomLevel;longitude=hash_longitude;latitude=hash_latitude;sceneId=hash_sceneId;birdseyeSceneOrientation=hash_birdseyeSceneOrientation;try{map.SetMapMode(mapMode);switch(mapStyle){case "r":case "a":case "h":map.SetMapStyle(mapStyle);map.AttachEvent("onchangeview",hideLoadingIndicatorAndDetach);map.AttachEvent("onendzoom",applyProperZoom);if(zoomLevel==defaultZoomLevelOfMapSet+1)map.SetCenterAndZoom(new VELatLong(latitude,longitude),zoomLevel);else map.SetCenterAndZoom(new VELatLong(latitude,longitude),zoomLevel-1);break;case "o":map.AttachEvent("onchangemapstyle",onChangeMapStyleOblique);map.SetMapStyle(mapStyle);break;case "b":map.AttachEvent("onchangemapstyle",onChangeMapStyleBirdseye);map.SetMapStyle(mapStyle);break}}catch(e){errorFunction(mapControlError,true);hideLoadingIndicator()}break}}function applyProperZoom(){try{map.SetZoomLevel(zoomLevel);map.DetachEvent("onendzoom",applyProperZoom)}catch(e){errorFunction(mapControlError,true);hideLoadingIndicator()}}function onChangeMapStyleOblique(event){try{map.AttachEvent("onchangeview",onChangeViewOblique)}catch(e){errorFunction(mapControlError,true);hideLoadingIndicator()}}function onChangeMapStyleBirdseye(event){try{map.AttachEvent("onchangeview",onChangeViewBirdseye)}catch(e){errorFunction(mapControlError,true);hideLoadingIndicator()}}function onChangeViewBirdseye(event){try{if(event.birdseyeSceneID!=sceneId){map.SetBirdseyeScene(sceneId);map.DetachEvent("onchangemapstyle",onChangeMapStyleBirdseye)}else{map.DetachEvent("onchangeview",onChangeViewBirdseye);setOtherParamsForBirdsEyeView()}}catch(e){errorFunction(mapControlError,true);hideLoadingIndicator()}}function onChangeViewOblique(event){try{if(event.birdseyeSceneID!=sceneId){map.SetBirdseyeScene(sceneId);map.DetachEvent("onchangemapstyle",onChangeMapStyleOblique)}else{map.DetachEvent("onchangeview",onChangeViewOblique);setOtherParamsForBirdsEyeView()}}catch(e){errorFunction(mapControlError,true);hideLoadingIndicator()}}function setOtherParamsForBirdsEyeView(){try{birdsEyeViewZoomLevel=parseInt(zoomLevel);centerPixel=new VEPixel(longitude,latitude);birdsEyeSceneGlobal=map.GetBirdseyeScene();var encLatLong=birdsEyeSceneGlobal.PixelToLatLong(centerPixel,birdsEyeViewZoomLevel);map.AttachEvent("onchangeview",hideLoadingIndicatorAndDetach);switch(birdseyeSceneOrientation){case "North":map.SetBirdseyeScene(encLatLong,VEOrientation.North,birdsEyeViewZoomLevel,dummyCallback);break;case "South":map.SetBirdseyeScene(encLatLong,VEOrientation.South,birdsEyeViewZoomLevel,dummyCallback);break;case "East":map.SetBirdseyeScene(encLatLong,VEOrientation.East,birdsEyeViewZoomLevel,dummyCallback);break;case "West":map.SetBirdseyeScene(encLatLong,VEOrientation.West,birdsEyeViewZoomLevel,dummyCallback);break}}catch(e){errorFunction(mapControlError,true);hideLoadingIndicator()}}function hideLoadingIndicatorAndDetach(){try{map.DetachEvent("onchangeview",hideLoadingIndicatorAndDetach);map.SetMapStyle(hash_mapStyle);setTimeout(hideLoadingIndicatorAndAttachViewHandler,3e3)}catch(e){errorFunction(mapControlError,true);hideLoadingIndicator()}}function hideLoadingIndicatorAndAttachViewHandler(){hideLoadingIndicator();map.AttachEvent("onchangeview",viewHandler)}function dummyCallback(){}function copyDataCode(){htmlContent=$("#divDataViewSampleCode").html();textContent=stripHTML(htmlContent);$.clipboard(textContent);$("#copyDataCodeButton").animate({opacity:"hide"},"fast");$("#copyDataCodeButton").animate({opacity:"show"},"slow")}function copyMapCode(){htmlContent=$("#divMapViewSampleCode").html();textContent=stripHTML(htmlContent);$.clipboard(textContent);$("#copyMapCodeButton").animate({opacity:"hide"},"fast");$("#copyMapCodeButton").animate({opacity:"show"},"slow")}function copyBarChartCode(){htmlContent=$("#divBarChartViewSampleCode").html();textContent=stripHTML(htmlContent);$.clipboard(textContent);$("#copyBarChartCodeButton").animate({opacity:"hide"},"fast");$("#copyBarChartCodeButton").animate({opacity:"show"},"slow")}function copyPieChartCode(){htmlContent=$("#divPieChartViewSampleCode").html();textContent=stripHTML(htmlContent);$.clipboard(textContent);$("#copyPieChartCodeButton").animate({opacity:"hide"},"fast");$("#copyPieChartCodeButton").animate({opacity:"show"},"slow")}function stripHTML(s){s=s.replace(/<\/PRE>/g,"\r\n");s=s.replace(/&nbsp;/g,"\r\n");s=s.replace(/\r\n\r\n/g,"\r\n");var re=/<\S[^><]*>/g;s=s.replace(re,"");s=s.replace(/&amp;/g,"&");s=s.replace(/&lt;/g,"<");s=s.replace(/&gt;/g,">");s=s.replace(/&nbsp;&nbsp;&nbsp;/g,"\t");s=s.replace(/<br \/>/g,"\r\n");return s}function barOption1Selected(){enableOption1Controls()}function barOption2Selected(){enableOption2Controls()}function pieOption1Selected(){enablePieOption1Controls()}function pieOption2Selected(){enablePieOption2Controls()}function enableOption1Controls(){var VerticalColumnOptions=document.getElementsByName("BarVerticalColumnOptions");for(i=0;i<VerticalColumnOptions.length;i++)VerticalColumnOptions[i].disabled=true;$("#ddlBarVertical").attr("disabled","disabled");$("#labelBarAggregate").attr("style","color:Gray");$("#labelBarAverage").attr("style","color:Gray");$("#VerticalComboBoxLabel").attr("style","color:Gray");$("#labelBarCount").removeAttr("style")}function enablePieOption1Controls(){var pieVerticalColumnOptions=document.getElementsByName("PieVerticalColumnOptions");for(i=0;i<pieVerticalColumnOptions.length;i++)pieVerticalColumnOptions[i].disabled=true;$("#ddlPieVertical").attr("disabled","disabled");$("#labelPieAggregate").attr("style","color:Gray");$("#labelPieAverage").attr("style","color:Gray");$("#labelPieVerticalComboBox").attr("style","color:Gray");$("#labelPieCount").removeAttr("style")}function enableOption2Controls(){var VerticalColumnOptions=document.getElementsByName("BarVerticalColumnOptions");for(i=0;i<VerticalColumnOptions.length;i++)VerticalColumnOptions[i].disabled=false;$("#ddlBarVertical").removeAttr("disabled");$("#labelBarAggregate").removeAttr("style");$("#labelBarAverage").removeAttr("style");$("#VerticalComboBoxLabel").removeAttr("style");$("#labelBarCount").attr("style","color:Gray")}function enablePieOption2Controls(){var pieVerticalColumnOptions=document.getElementsByName("PieVerticalColumnOptions");for(i=0;i<pieVerticalColumnOptions.length;i++)pieVerticalColumnOptions[i].disabled=false;$("#ddlPieVertical").removeAttr("disabled");$("#labelPieAggregate").removeAttr("style");$("#labelPieAverage").removeAttr("style");$("#labelPieVerticalComboBox").removeAttr("style");$("#labelPieCount").attr("style","color:Gray")}function horizontalBarComboBoxSelected(selectedValue){var index=selectedValue.toString().indexOf("^",0),datatype=selectedValue.toString().substring(0,index);if(datatype=="System.DateTime"){$("#labelBarDateRange").attr("style","display:block;");$("#ddlBarDateRange").attr("style","display:block;")}else{$("#labelBarDateRange").attr("style","display:none;");$("#ddlBarDateRange").attr("style","display:none;")}SetBarChartLabel()}function SetBarChartLabel(){$("#labelBarCount > span").remove();var columnNameSelected=$("#ddlBarHorizontal > option:selected").text();if(columnNameSelected==defaultSelectOneText)columnNameSelected=horizontalAxisColText;else if(columnNameSelected.length>20)columnNameSelected=columnNameSelected.substring(0,20)+"..";$("#labelBarCount").append("<span>&ldquo;"+columnNameSelected+"&rdquo;</span>")}function horizontalPieComboBoxSelected(selectedValue){var index=selectedValue.toString().indexOf("^",0),datatype=selectedValue.toString().substring(0,index);if(datatype=="System.DateTime"){$("#labelPieDateRange").attr("style","display:block;");$("#ddlPieDateRange").attr("style","display:block;")}else{$("#labelPieDateRange").attr("style","display:none;");$("#ddlPieDateRange").attr("style","display:none;")}SetPieChartLabel()}function SetPieChartLabel(){$("#labelPieCount > span").remove();var columnNameSelected=$("#ddlPieHorizontal > option:selected").text();if(columnNameSelected==defaultSelectOneText)columnNameSelected=horizontalAxisColText;else if(columnNameSelected.length>20)columnNameSelected=columnNameSelected.substring(0,20)+"..";$("#labelPieCount").append("<span>&ldquo;"+columnNameSelected+"&rdquo;</span>")}function ShowBarChartError(){document.getElementById("divBarChartError").style.display="block";document.getElementById("divBarChartResults").style.display="none"}function ShowPieChartError(){document.getElementById("divPieChartError").style.display="block";document.getElementById("divPieChartResults").style.display="none"}function showBarChartGraph(){document.getElementById("divBarChartError").style.display="none";document.getElementById("divBarChartResults").style.display="block"}function showPieChartGraph(){document.getElementById("divPieChartError").style.display="none";document.getElementById("divPieChartResults").style.display="block";if(navigator.appName=="Netscape")document.getElementById("divPieResultHeight").style.height="100%"}function GetFilter(){var filter=$("#queryBox").val().replace(/^\s+|\s+$/g,"");if(filter.indexOf(defaultFilterText,0)>=0)filter=noFilterText;return filter}function SetFilter(filter){if(filter==noFilterText)filter=defaultFilterText;document.getElementById("queryBox").value=filter}function showLoadingIndicator(){var bodyHeight=getBodyHeight(),bodyWidth=getBodyWidth();$("#BackGroundLoadingIndicator").attr("style","display:block;height:"+bodyHeight+"px;width:"+bodyWidth+"px");$("#LoadingIndicatorPanel").attr("style","display:block;");$("#imgLoading").attr("style","display:block;")}function hideLoadingIndicator(){$("#LoadingIndicatorPanel").attr("style","display:none;");$("#BackGroundLoadingIndicator").attr("style","display:none;");$("#imgLoading").attr("style","display:none;")}function getBodyWidth(){var width=0,scrollWidth=0,offsetWidth=0,maxWidth=0;if(document.width)width=document.width;else if(document.body){if(document.body.scrollWidth)width=scrollWidth=document.body.scrollWidth;if(document.body.offsetWidth)width=offsetWidth=document.body.offsetWidth;if(scrollWidth&&offsetWidth){width=maxWidth=Math.max(scrollWidth,offsetWidth);if(scrollWidth!=offsetWidth)width=width*(1003/936);if(screen.width)width=maxWidth=Math.max(width,screen.width)}}if(navigator.appName=="Microsoft Internet Explorer"||navigator.appName=="Opera")return width;else if(navigator.appName=="Netscape")return Math.max(screen.width,window.innerWidth);else return width}function getBodyHeight(){var height=0,scrollHeight=0,offsetHeight=0,maxHeight;if(document.height)height=document.height;else if(document.body){if(document.body.scrollHeight)height=scrollHeight=document.body.scrollHeight;if(document.body.offsetHeight)height=offsetHeight=document.body.offsetHeight;if(scrollHeight&&offsetHeight)height=maxHeight=Math.max(scrollHeight,offsetHeight)}if(navigator.appName=="Microsoft Internet Explorer")return height;else return window.screen.availHeight*(screen.deviceYDPI/screen.logicalYDPI)}window.onresize=setLayerPosition;function setLayerPosition(){var backGroundLoadingIndicator=document.getElementById("BackGroundLoadingIndicator");backGroundLoadingIndicator.style.width=getBodyWidth()+"px";backGroundLoadingIndicator.style.height=getBodyHeight()+"px"}function getBarChartParametersInCurrentVariables(){current_horizontalColumnName=$("#ddlBarHorizontal > option:selected").attr("text");if(current_horizontalColumnName==undefined||current_horizontalColumnName==defaultSelectOneText)current_horizontalColumnName="X";var xDateRange=document.getElementById("ddlBarDateRange");if(xDateRange.style.display!="block")current_dateRange="X";else current_dateRange=$("#ddlBarDateRange > option:selected").attr("text");var VerticalOptions=document.getElementsByName("BarVerticalOptions");current_verticalOptions="";for(i=0;i<VerticalOptions.length;i++)if(VerticalOptions[i].checked){current_verticalOptions=VerticalOptions[i].value;break}current_verticalColumnName=$("#ddlBarVertical > option:selected").attr("text");if(current_verticalColumnName==undefined||current_verticalColumnName==defaultSelectOneText)current_verticalColumnName="X";var VerticalColumnOptions=document.getElementsByName("BarVerticalColumnOptions");current_verticalColumnOptions="";for(i=0;i<VerticalColumnOptions.length;i++)if(VerticalColumnOptions[i].checked){current_verticalColumnOptions=VerticalColumnOptions[i].value;break}}function getPieChartParametersInCurrentVariables(){current_horizontalColumnName=$("#ddlPieHorizontal > option:selected").attr("text");if(current_horizontalColumnName==undefined||current_horizontalColumnName==defaultSelectOneText)current_horizontalColumnName="X";var xDateRange=document.getElementById("ddlPieDateRange");if(xDateRange.style.display!="block")current_dateRange="X";else current_dateRange=$("#ddlPieDateRange > option:selected").attr("text");var pieVerticalOptions=document.getElementsByName("PieVerticalOptions");current_verticalOptions="";for(i=0;i<pieVerticalOptions.length;i++)if(pieVerticalOptions[i].checked){current_verticalOptions=pieVerticalOptions[i].value;break}current_verticalColumnName=$("#ddlPieVertical > option:selected").attr("text");if(current_verticalColumnName==undefined||current_verticalColumnName==defaultSelectOneText)current_verticalColumnName="X";var pieVerticalColumnOptions=document.getElementsByName("PieVerticalColumnOptions");current_verticalColumnOptions="";for(i=0;i<pieVerticalColumnOptions.length;i++)if(pieVerticalColumnOptions[i].checked){current_verticalColumnOptions=pieVerticalColumnOptions[i].value;break}}function debug(){alert("\nhash_filter-->"+hash_filter+"\nhash_viewType-->"+hash_viewType+"\nhash_tagType-->"+hash_tagType+"\nhash_language-->"+hash_language+"\nhash_horizontalColumnName-->"+hash_horizontalColumnName+"\nhash_dateRange-->"+hash_dateRange+"\nhash_verticalOptions-->"+hash_verticalOptions+"\nhash_verticalColumnName-->"+hash_verticalColumnName+"\nhash_verticalColumnOptions-->"+hash_verticalColumnOptions+"\n\n\nhash_mapStyle-->"+hash_mapStyle+"\nhash_zoomLevel-->"+hash_zoomLevel+"\nhash_longitude-->"+hash_longitude+"\nhash_latitude-->"+hash_latitude+"\nhash_sceneId-->"+hash_sceneId+"\nhash_birdseyeSceneOrientation-->"+hash_birdseyeSceneOrientation+"\n\n\ncurrent_filter-->"+current_filter+"\ncurrent_viewType-->"+current_viewType+"\ncurrent_tagType-->"+current_tagType+"\ncurrent_language-->"+current_language+"\ncurrent_horizontalColumnName-->"+current_horizontalColumnName+"\ncurrent_dateRange-->"+current_dateRange+"\ncurrent_verticalOptions-->"+current_verticalOptions+"\ncurrent_verticalColumnName-->"+current_verticalColumnName+"\ncurrent_verticalColumnOptions-->"+current_verticalColumnOptions+"\n\n\ncurrent_mapStyle-->"+current_mapStyle+"\ncurrent_zoomLevel-->"+current_zoomLevel+"\ncurrent_longitude-->"+current_longitude+"\ncurrent_latitude-->"+current_latitude+"\ncurrent_sceneId-->"+current_sceneId+"\ncurrent_birdseyeSceneOrientation-->"+current_birdseyeSceneOrientation)}